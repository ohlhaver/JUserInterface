<% form_id = "edit_preference_#{@user.id}" %>
<% content_for :custom_javascript do %>
  <%= observe_form( form_id, :function => "$('#{form_id}').submit();" ) %>
<% end %>
<div class='news_block'>
  <h2><%=t( 'navigation.main.search_and_sorting') %></h2>
</div>
<% form_for(@preference, :url => preference_path( @user ), :html => { :method => :put, :class => "edit_preference", :id => form_id }  ) do |f| %>
  <div class='news_block'>
    <div class='clearfix'>
      <div class='grid_1'>
        <%= f.label :default_sort_criteria, t('prefs.labels.sort_criteria') %>
      </div>
      <div class='grid_1'>
        <%= f.select :default_sort_criteria, Preference.for_select( :default_sort_criteria ) %>
      </div>
    </div>
    <div class='clearfix'>
      <div class='grid_1'>
        <%= f.label :default_time_span, t('prefs.labels.time_span') %>
      </div>
      <div class='grid_1'>
        <%= f.select :default_time_span, Preference.for_select( :default_time_span ) %>
      </div>
    </div>
  </div>
  <div class='news_block'>
    <div class='clearfix'>
      <div class='grid_1'>
        <%= f.label :video, t('prefs.labels.video_pref') %>
      </div>
      <div class='grid_1'>
        <%= f.select :video, Preference.for_select( :video ) %>
      </div>
    </div>
    <div class='clearfix'>
      <div class='grid_1'>
        <%= f.label :opinion, t('prefs.labels.opinion_pref') %>
      </div>
      <div class='grid_1'>
        <%= f.select :opinion, Preference.for_select( :opinion ) %>
      </div>
    </div>
    <div class='clearfix'>
      <div class='grid_1'>
        <%= f.label :blog, t('prefs.labels.blog_pref') %>
      </div>
      <div class='grid_1'>
        <%= f.select :blog, Preference.for_select( :blog ) %>
      </div>
    </div>
  </div>
  <div class='news_block'>
    <div class='clearfix'>
      <div class='grid_1'>
        <%= f.label :subscription_type, t('prefs.labels.subscription_type') %>
      </div>
      <div class='grid_1'>
        <%= f.select :subscription_type, Preference.for_select( :subscription_type ) %>
      </div>
    </div>
  </div>
  <div class='news_block'>
    <div class='clearfix'>
      <div class='grid_2'>
        <%= f.label :search_language_ids, t('prefs.labels.search_languages') %><br />
        <% Preference.for_select( :default_language_id ).each do |language| %>
          <%= hidden_field_tag( "preference[search_language_ids][#{language.last}]", "0") %>
          <%= check_box_tag( "preference[search_language_ids][#{language.last}]", "1", f.object.search_language_id_exists?( language.last ) ) %> <%= language.first %>
          <br />
        <% end %>
      </div>
    </div>
  </div>
  <%= hidden_field_tag( :return_to, request.url ) %>
<% end %>